(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["search"],{"05c0":function(t,e,s){"use strict";var a=s("9e28"),i=s.n(a);i.a},"794be":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"wrap"},[s("div",{staticClass:"search-wrap"},[s("i",{staticClass:"iconfont icon-search1"}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],staticClass:"search",attrs:{type:"text",placeholder:"搜索歌曲"},domProps:{value:t.query},on:{input:function(e){e.target.composing||(t.query=e.target.value)}}}),s("i",{directives:[{name:"show",rawName:"v-show",value:t.query,expression:"query"}],staticClass:"iconfont icon-close-s",on:{click:t.handleClose}})]),s("div",{staticClass:"search-query"},[s("dl",{staticClass:"hot"},[s("dt",{staticClass:"hot-title"},[t._v("热门搜索")]),t._l(t.hotList,function(e,a){return s("dd",{key:a,staticClass:"hot-item",on:{click:function(s){return t.handleSearch(e.first)}}},[t._v(t._s(e.first))])})],2),s("dl",{staticClass:"history"},[s("dt",{staticClass:"history-title"},[t._v("搜索历史 "),s("i",{staticClass:"iconfont icon-clear",on:{click:t.handleClear}})]),t._l(t.searchHistory,function(e,a){return s("dd",{key:a,staticClass:"history-item",on:{click:function(s){return t.handleSearch(e)}}},[t._v("\n            "+t._s(e)+"\n            "),s("i",{staticClass:"iconfont icon-close",on:{click:function(e){return e.stopPropagation(),t.handleDelete(a)}}})])})],2)]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.query,expression:"query"}],staticClass:"search-content"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.searchState.start,expression:"!searchState.start"}],staticClass:"search-suggest"},[s("ul",[s("li",{staticClass:"suggest-item keyword",on:{click:function(e){return t.handleSearch(t.query)}}},[t._v('搜索"'+t._s(t.query)+'"')]),t._l(t.suggestList,function(e,a){return s("li",{key:a,staticClass:"suggest-item",on:{click:function(s){return t.handleSearch(e.keyword)}}},[t._v(t._s(e.keyword))])})],2)]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.searchState.start,expression:"searchState.start"}],staticClass:"search-result"},[s("p",{directives:[{name:"show",rawName:"v-show",value:!t.searchState.result&&0===t.resultList.length,expression:"!searchState.result&&resultList.length===0"}]},[t._v("搜索中...")]),s("p",{directives:[{name:"show",rawName:"v-show",value:t.noResult,expression:"noResult"}]},[t._v("暂无搜索结果")]),s("dl",{directives:[{name:"show",rawName:"v-show",value:t.noMatch,expression:"noMatch"}],staticClass:"match"},[s("dt",[t._v("最佳匹配")]),t.matchList.album?s("dd",{staticClass:"result-item match-item",on:{click:function(e){return t.handleMatchAlbum(t.matchList.album[0].id)}}},[s("div",{staticClass:"cover"},[s("img",{attrs:{src:t.matchList.album[0].picUrl}})]),s("div",{staticClass:"desc"},[s("h4",[t._v("专辑："+t._s(t.matchList.album[0].name))]),s("p",[t._v(t._s(t.matchList.album[0].artist.name))])]),s("i",{staticClass:"iconfont icon-ahead"})]):t._e(),t.matchList.artist?s("dd",{staticClass:"result-item match-item",on:{click:function(e){return t.handleMatchSinger(t.matchList.artist[0].id)}}},[s("div",{staticClass:"cover"},[s("img",{attrs:{src:t.matchList.artist[0].img1v1Url}})]),s("div",{staticClass:"desc"},[s("h4",[t._v("歌手："+t._s(t.matchList.artist[0].name))])]),s("i",{staticClass:"iconfont icon-ahead"})]):t._e()]),s("ul",{staticClass:"song"},t._l(t.resultList,function(e,a){return s("li",{key:e.id,staticClass:"result-item song-item",on:{click:function(e){return t.handleSelect(a)}}},[s("div",{staticClass:"desc"},[s("h4",{staticClass:"song-name"},[t._v(t._s(e.name))]),s("p",{staticClass:"singer-name"},[t._v(t._s(e.singerName))])]),s("i",{staticClass:"iconfont icon-play-s"})])}),0)])])]),s("animation-fade",[s("router-view")],1)],1)},i=[],n=s("cebc"),c=s("da71"),r=s("bc3a"),o=s.n(r);function u(){return o.a.get("".concat(c["b"],"/search/hot")).then(function(t){return Promise.resolve(t.data)})}function h(t){return o.a.get("".concat(c["b"],"/search/suggest?keywords=").concat(t,"&type=mobile")).then(function(t){return Promise.resolve(t.data)})}function l(t){return o.a.get("".concat(c["b"],"/search/multimatch?keywords=").concat(t)).then(function(t){return Promise.resolve(t.data)})}function m(t){return o.a.get("".concat(c["b"],"/search?keywords=").concat(t)).then(function(t){return Promise.resolve(t.data)})}var d=s("f5de"),f=s("2f62"),v={name:"search",data:function(){return{hotList:[],query:"",suggestList:[],matchList:{},resultList:[],searchState:{start:!1,result:!1,suggestReady:!0}}},computed:Object(n["a"])({},Object(f["c"])(["searchHistory"]),{noResult:function(){return this.searchState.result&&0===this.resultList.length&&!this.noMatch},noMatch:function(){return this.matchList.album||this.matchList.artist}}),watch:{query:function(){var t=this;if(this.searchState.suggestReady)if(""===this.query)this.suggestList=[];else{var e=null;e&&clearTimeout(e),e=setTimeout(function(){t._getSearchSuggest(t.query)},300)}}},mounted:function(){this._getHot()},methods:Object(n["a"])({},Object(f["d"])({addSearchHistory:"ADD_SEARCH_HISTORY",deleteSearchHistory:"DELETE_SEARCH_HISTORY",clearSearchHistory:"CLEAR_SEARCH_HISTORY"}),Object(f["b"])(["selectPlay"]),{_getHot:function(){var t=this;u().then(function(e){e.code===c["a"]&&(t.hotList=e.result.hots)})},_getSearchSuggest:function(t){var e=this;this.searchState.start=!1,this.query&&h(t).then(function(t){t.code===c["a"]&&(e.suggestList=t.result.allMatch)})},handleSearch:function(t){this.query=t,this.searchState.suggestReady=!1,this.searchState.start=!0,this.searchState.result=!1,this.matchList={},this.resultList=[],this._getSearchMatch(t),this._getSearchResult(t),this.addSearchHistory(t)},_getSearchMatch:function(t){var e=this;l(t).then(function(t){t.code===c["a"]&&(e.matchList=t.result)})},_getSearchResult:function(t){var e=this;m(t).then(function(t){if(t.code===c["a"]){if(t.result.songs){var s=t.result.songs;e.resultList=Object(d["c"])(s)}else e.resultList=[];e.searchState.result=!0,e.searchState.suggestReady=!0}}).catch(function(){e.resultList=[],e.searchState.result=!0,e.searchState.suggestReady=!0})},handleClose:function(){this.query=""},handleSelect:function(t){this.selectPlay({list:this.resultList,index:t})},handleDelete:function(t){this.deleteSearchHistory(t)},handleClear:function(){this.clearSearchHistory()},handleMatchSinger:function(t){this.$router.push("/search/singer/".concat(t))},handleMatchAlbum:function(t){this.$router.push("/search/album/".concat(t))}})},g=v,y=(s("05c0"),s("2877")),S=Object(y["a"])(g,a,i,!1,null,"bff05856",null);e["default"]=S.exports},"9e28":function(t,e,s){},f5de:function(t,e,s){"use strict";s.d(e,"a",function(){return c}),s.d(e,"b",function(){return r}),s.d(e,"c",function(){return o});s("ac6a"),s("7f7f");var a=s("d225"),i=function t(e){var s=e.id,i=e.name,n=e.singerName,c=e.coverImg,r=e.albumName;Object(a["a"])(this,t),this.id=s,this.name=i,this.singerName=n,this.coverImg=c,this.albumName=r};function n(t,e){var s=[];return t?(t.forEach(function(t){s.push(t[e])}),s.join("/")):""}function c(t){var e=[];return t.forEach(function(t){e.push(new i({id:t.id,name:t.name,singerName:n(t.song.artists,"name"),coverImg:t.song.album.picUrl,albumName:t.song.album.name}))}),e}function r(t){var e=[];return t.forEach(function(t){e.push(new i({id:t.id,name:t.name,singerName:n(t.ar,"name"),coverImg:t.al.picUrl,albumName:t.al.name}))}),e}function o(t){var e=[];return t.forEach(function(t){e.push(new i({id:t.id,name:t.name,singerName:n(t.artists,"name"),coverImg:"",albumName:t.album.name}))}),e}}}]);
//# sourceMappingURL=search.8e55ded4.js.map